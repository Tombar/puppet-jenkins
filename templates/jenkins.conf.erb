upstream jenkins.dev {
  server 127.0.0.1:<%= scope.lookupvar "jenkins::config::port" %> fail_timeout=0;
}

server {
  access_log <%= scope.lookupvar "jenkins::config::accesslogfile" %>
  error_log <%= scope.lookupvar "jenkins::config::errorlogfile" %>
  listen 80;
  server_name jenkins.dev;

  client_max_body_size 50M;

  error_page 500 502 503 504 /50x.html;

  if ($host ~* "www") {
    rewrite ^(.*)$ http://jenkins.dev$1 permanent;
    break;
  }

}
